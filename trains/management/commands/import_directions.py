__author__ = 'Victor Varvariuc <victor.varvariuc@gmail.com>'

from django.core.management.base import BaseCommand
from django.db import transaction
from django.db.utils import IntegrityError

from trains.models import Region, Direction, Station


# взял на сайте Яндекса http://m.rasp.yandex.ru/direction?city=213
STATIONS = {
    'Москва': {
        'Белорусское': {
            2000006: 'Москва (Белорусский вокзал) [м.Белорусская]',
            9601666: 'Беговая [м.Беговая]',
            9601349: 'Тестовская',
            9600821: 'Фили [м.Фили]',
            9601728: 'Кунцево [м.Кунцевская]',
            9600911: 'Рабочий Посёлок',
            9600941: 'Сетунь',
            9602258: 'Немчиновка',
            9602218: 'Трёхгорка',
            9601338: 'Баковка',
            9600721: 'Одинцово',
            9601231: 'Отрадное',
            9601641: 'Пионерская',
            9601172: 'Перхушково',
            9602229: 'Здравница',
            9601212: 'Жаворонки',
            9601725: 'Дачное',
            9601658: 'Малые Вязёмы',
            9602265: 'Голицыно',
            9600777: 'Сушкинская',
            9601717: 'Петелино',
            9601817: 'Часцовская',
            9602459: 'Портновская',
            9600748: 'Кубинка 1',
            9601733: 'Чапаевка',
            9601718: 'Полушкино',
            9601864: 'Санаторная',
            9602011: 'Тучково',
            9601754: 'Театральная',
            9601840: 'Садовая',
            9601629: 'Дорохово',
            9601799: 'Партизанская',
            9601773: 'Шаликово',
            9601890: 'Кукаринская',
            9601664: '109 км',
            9601006: 'Можайск',
            9601458: 'Бородино',
            9601459: 'Колочь',
            9601460: 'Уваровка',
            9601357: '144 км',
            9633995: '147 км',
            9601462: 'Дровнино',
            9601894: 'Батюшково',
            9601230: 'Колесники',
            9601463: 'Гагарин',
            9601464: 'Василисино',
            9601465: 'Серго-Ивановская',
            9633656: '205 км',
            9601466: 'Туманово',
            9633996: '215 км',
            9601138: '218 км',
            9601467: 'Мещёрская',
            9601193: 'Подъёлки',
            9601145: 'Комягино',
            9601160: 'Зубарёвка',
            9601461: 'Вязьма',

            9600213: 'а/п Шереметьево',

            9601659: 'Захарово',
            9601746: 'Хлюпино',
            9601858: 'Скоротово',
            9601368: 'Звенигород',

            9601679: 'Ромашково',
            9601701: 'Раздоры',
            9601655: 'Барвиха',
            9601663: 'Ильинское',
            9601678: 'Усово',
        },
        'Горьковское': {
            2000001: 'Москва (Курский вокзал) [м.Курская, Чкаловская]',
            9601796: 'Серп и Молот [м.Площадь Ильича]',
            9601835: 'Карачарово',
            9601856: 'Чухлинка',
            9601671: 'Кусково',
            9601737: 'Новогиреево',
            9600796: 'Реутово',
            9601177: 'Никольское',
            9601902: 'Салтыковская',
            9601767: 'Кучино',
            9601675: 'Железнодорожная',
            9601301: 'Чёрное',
            9633651: 'Заря',
            9601192: 'Купавна',
            9600773: '33 км',
            9601867: 'Электроугли',
            9601631: '43 км',
            9602038: 'Храпуново',
            9601783: 'Есино',
            9601680: 'Фрязево',
            9601782: 'Казанское',
            9601653: 'Вохна',
            9601872: 'Павловский Посад',
            9601755: 'Назарьево',
            9602082: 'Дрезна',
            9600699: 'Кабаново',
            9634002: '87 км',
            9601539: 'Орехово-Зуево',
            9602107: 'Крутое',
            9601734: 'Войново',
            9600684: 'Усад',
            9601795: 'Глубоково',
            9601645: 'Покров',
            9601363: '113 км',
            9601811: 'Омутище',
            9601828: 'Леоново',
            9612144: 'Петушки',
            9612145: 'Костерёво',
            9612146: 'Болдино',
            9612727: 'Сушнево',
            9612147: 'Ундол',
            9612561: '170 км',
            9612148: 'Колокша',
            9612149: 'Юрьевец',
            2060340: 'Владимир',

            9602227: 'Ленская',
            9600983: 'Ковригино',
            9601876: '14 км',
            9600677: 'Электрогорск',

            9600835: 'Стройка',
            9601665: 'Горенки',
            9602120: 'Балашиха',

            9601721: 'Металлург',
            9601112: 'Электросталь',
            9601319: 'Машиностроитель',
            9601939: 'Ногинск',
            9601712: 'Захарово',
        },
        'Казанское': {
            2000003: 'Москва (Казанский вокзал) [м.Комсомольская]',
            9601647: 'Электрозаводская [м.Электрозаводская]',
            9601335: 'Сортировочная',
            9601642: 'Новая [м.Авиамоторная]',
            9601991: 'Фрезер',
            9600931: 'Перово',
            9601186: 'Плющево',
            9601964: 'Вешняки',
            9601627: 'Выхино',
            9601635: 'Косино',
            9601152: 'Ухтомская',
            9601636: 'Люберцы 1',
            9601919: 'Панки',
            9601822: 'Томилино',
            9602033: 'Красково',
            9601758: 'Малаховка',
            9601915: 'Удельная',
            9600921: 'Быково',
            9601929: 'Ильинская',
            9602223: 'Отдых',
            9601438: 'Кратово',
            9601504: '42 км',
            9600961: 'Фабричная',
            9601841: 'Раменское',
            9601197: '47 км',
            9600770: 'Совхоз',
            9601690: 'Загорново',
            9601978: 'Бронницы',
            9601324: 'Радуга',
            9601707: '63 км',
            9602006: 'Белоозёрская',
            9602276: 'Фаустово',
            9601194: 'Золотово',
            9602075: 'Виноградово',
            9601634: 'Конобеево',
            9633647: 'Трофимово',
            9601903: '88 км',
            9600705: 'Воскресенск',
            9601654: 'Шиферная',
            9602059: 'Москворецкая',
            9601983: 'Цемгигант',
            9600707: 'Пески',
            9601837: 'Конев Бор',
            9602286: 'Хорошово',
            9601950: '113 км',
            9601311: 'Коломна',
            9600716: 'Голутвин',
            9601772: 'Щурово',
            9601806: 'Чёрная',
            9600726: 'Луховицы',
            9601205: '142 км',
            9600708: 'Подлипки',
            9600709: 'Фруктовая',
            9600710: 'Алпатьево',
            9601011: 'Слёмы',
            9600712: 'Дивово',
            9601766: 'Истодники',
            9633648: '179 км',
            9600736: 'Рыбное',
            9600690: 'Ходынино',
            9633649: 'Депо',
            9601809: 'Рязань-Сорт. (Жилые дома)',
            9601812: '187 км',
            9633997: '189 км',
            9601242: 'Недостоево',
            9600713: 'Дягилево',
            9601670: 'Лагерный',
            9600786: 'Рязань-1',
            9600746: 'Рязань-2',

            9601760: 'Люберцы 2',
            9600954: 'Коренёво',
            9601769: 'Овражки',
            9602225: 'Родники',
            9601793: 'Вялки',
            9601801: 'Хрипань',
            9600999: '41 км',
            9601838: 'Донино',
            9601762: '49 км',
            9601786: '52 км',
            9602231: 'Григорово',
            9601738: '55 км',
            9601644: 'Гжель',
            9601739: 'Игнатьево',
            9601842: 'Кузяево',
            9601723: 'Шевлягино',
            9601337: '73 км',
            9601776: 'Анциферово',
            9601843: 'Подосинки',
            9602024: 'Куровская',
            9601282: 'Нерская',
            9602211: '90 км',
            9601845: '95 км',
            9601672: 'Авсюнино',
            9600698: 'Ильинский Погост',
            9601128: '32 км',
            9601839: 'Заполицы',
            9601808: 'Запутная',
            9601727: 'Егорьевск',
            9601761: 'Шатурторф',
            9602291: 'Шатура',
            9601165: 'Ботино',
            9601781: 'Кривандино',
            9601847: 'Туголесье',
            9601199: 'Воймежный',
            9600704: 'Черусти',
            9612113: 'Струя',
            9612532: 'Тасин',
            9612181: 'Ильичёв',
            9612182: 'Торфопродукт',
            9612103: 'Мильцево',
            9612180: 'Нечаевская',
            9633650: 'Депо',
            9612500: 'Вековка',
        },
        'Киевское': {
            2000007: 'Москва (Киевский вокзал) [м.Киевская]',
            9601674: 'Москва-Сортировочная',
            9600771: 'Матвеевская',
            9600881: 'Очаково',
            9601342: 'Сколково',
            9600981: 'Солнечная',
            9602014: 'Переделкино',
            9601731: 'Мичуринец',
            9602271: 'Внуково',
            9601373: 'Лесной Городок',
            9600702: 'Толстопальцево',
            9601187: 'Кокошкино',
            9602221: 'Крёкшино',
            9601710: 'Победа',
            9601102: 'Апрелевка',
            9602317: 'Дачная',
            9601669: 'Алабино',
            9601383: 'Селятино',
            9601650: 'Рассудово',
            9601821: 'Ожигово',
            9601625: 'Бекасово-1',
            9601730: 'Зосимова Пустынь',
            9601137: 'Нара',
            9601820: 'Латышская',
            9601804: 'Башкино',
            9601749: 'Ворсино',
            9601347: 'Балабаново',
            9601907: 'Обнинское',
            9602311: 'Шемякино',
            9601002: 'Малоярославец',
            9601747: 'Ерденево',
            9602318: '140 км',
            9601004: 'Суходрев',
            9601789: 'Родинка',
            9601818: 'Сляднево',
            9601972: '167 км',
            9600237: 'Тихонова Пустынь',
            9601009: 'Горенская',
            2000350: 'Калуга-2',
            9602319: '188 км',
            9601010: 'Воротынск',
            9601113: '196 км',
            9602320: '200 км',
            9601944: 'Дяглевка',
            9601012: 'Бабынино',
            9601973: '218 км',
            9601013: 'Домашёвка',
            9601918: 'Липицы',
            9601015: 'Кудринская',
            9602451: '245 км',
            9601239: 'Хотень',
            9601023: 'Сухиничи-узловые',
            9601033: 'Сухиничи-главные',

            9601008: 'Муратовка',
            9601686: 'Садовая',
            9601032: 'Азарово',
            2000345: 'Калуга-1',

            9654533: 'Аэропорт (старая платф.)',
            9600215: 'а/п Внуково',

            9602144: 'Посёлок Киевский',
            9601133: 'Бекасово-сортировочное',
            9602139: 'Бекасово-центральное',
            9602145: '240 км',
            9602146: '241 км',
            9601909: 'Мачихино',
            9633993: '250 км',
            9602147: '252 км',
            9602071: 'Кресты',

            9799753: 'Новопеределкино',
        },
        'Кольцевое': {
            9601682: 'Яхрома',
            9600692: 'Дмитров',
            9601273: 'Иванцево',
            9633659: '80 км',
            9602292: 'Драчёво',
            9602170: '74 км',
            9602171: '71 км',
            9602172: '68 км',
            9601386: 'Костино',
            9602173: '62 км',
            9602034: 'Жёлтиково',
            9602174: '47 км',
            9602031: 'Бубяково',
            9602175: '40 км',
            9602032: 'Наугольный',
            9601684: '81 км',
            9601547: 'Александров-1',
            9600685: 'Александров-2',
            9600687: 'Карабаново',
            9601940: '126 км',
            9600688: 'Бельково',
            9601176: '138 км',
            9602224: 'Киржач',
            9601928: 'Илейкино',
            9601529: '157 км',
            9601791: 'Санино',
            9602484: '168 км',
            9601869: 'Ветчи',
            9601350: '173 км',
            9602278: '178 км',
            9602282: 'Поточино',
            9601539: 'Орехово-Зуево',
            9633661: 'Северный',
            9633662: 'Депо',
            9633663: 'Центральный',
            9633664: '122 км',
            9601184: 'Дулёво',
            9601198: 'Давыдово',
            9602024: 'Куровская',
            9601282: 'Нерская',
            9600698: 'Ильинский Погост',
            9601169: 'Берендино',
            9601294: 'Лопатино',
            9601128: '32 км',
            9601727: 'Егорьевск',
            9601861: 'Рудниковская',
            9601932: 'Хорлово',
            9601903: '88 км',
            9600705: 'Воскресенск',
            9601208: 'Ратмирово',
            9601216: 'Непецино',
            9601270: 'Осёнка',
            9602266: 'Шкинь',
            9601220: 'Лесные Дары',
            9601260: 'Шубатово',
            9601234: 'Мякинино',
            9602293: 'Лютик',
            9601826: 'Яганово',
            9602153: '341 км',
            9601115: 'Малино',
            9602152: '332 км',
            9601060: '328 км',
            9600749: 'Михнево',
            9601255: 'Усады-окружные',
            9602246: '312 км',
            9601120: '309 км',
            9601827: 'Повадино',
            9601297: 'Детково',
            9601626: 'Столбовая',
            9602151: '283 км',
            9601941: 'Сандарово',
            9602150: 'Вяткино',
            9602148: '274 км',
            9601948: 'Чернецкое',
            9601356: 'Новогромово',
            9602071: 'Кресты',
            9602147: '252 км',
            9633993: '250 км',
            9601909: 'Мачихино',
            9602146: '241 км',
            9602145: '240 км',
            9602139: 'Бекасово-центральное',
            9601133: 'Бекасово-сортировочное',
            9602144: 'Посёлок Киевский',
            9601625: 'Бекасово-1',
            9602129: 'Пожитково',
            9602143: '221 км',
            9601709: 'Акулово',
            9602142: '214 км',
            9633665: '211 км',
            9600748: 'Кубинка 1',
            9600982: 'Кубинка 2',
            9602141: '199 км',
            9602069: 'Ястребки',
            9602140: '192 км',
            9601359: '190 км',
            9602104: 'Дюдьково',
            9601863: '183 км',
            9602137: '177 км',
            9633994: '174 км',
            9602085: 'Лукино',
            9602042: '165 км',
            9602054: 'Манихино 2',
            9601575: '159 км',
            9602136: '155 км',
            9601567: 'Жилино',
            9602135: 'Депо',
            9601292: 'Поварово-3',
            9601021: '142 км',
            9601693: 'Поварово-2',
            9602119: '128 км',
            9601362: 'Бухарово',
            9602154: '120 км',
            9602290: '116 км',
            9601164: 'Белый Раст',
            9601303: '109 км',
            9601681: 'Икша',
            9601651: 'Манихино 1',
            9601257: 'Сотниково',
            9601058: 'Колычёво',
            9601174: 'Шматово',
            9600694: 'Жилёво',
        },
        'Курское': {
            9601382: 'Савёловская [м.Савеловская]',
            9601384: 'Станколит',
            9601266: 'Ржевская [м.Рижская]',
            2001005: 'Москва-Каланчёвская [м.Комсомольская]',
            2000001: 'Москва (Курский вокзал) [м.Курская, Чкаловская]',
            9601813: 'Москва-Товарная',
            9600866: 'Калитники',
            9600711: 'Текстильщики [м.Текстильщики]',
            9601788: 'Люблино',
            9602245: 'Депо',
            9601898: 'Перерва',
            9601711: 'Москворечье',
            9600891: 'Царицыно [м.Царицыно]',
            9601256: 'Покровская',
            9601943: 'Красный Строитель',
            9600703: 'Битца',
            9601291: 'Бутово',
            9600951: 'Щербинка',
            9602273: 'Силикатная',
            9600731: 'Подольск',
            9601494: 'Кутузовская',
            9601207: 'Весенняя',
            9601157: 'Гривно',
            9601276: 'Львовская',
            9601752: 'Колхозная',
            9601626: 'Столбовая',
            9602313: '66 км',
            9602222: 'Чепелёво',
            9601062: 'Чехов',
            9601743: 'Луч',
            9602216: 'Шарапова Охота',
            9601661: '92 км',
            9600832: 'Авангард',
            9600830: 'Серпухов',
            9601185: 'Ока',
            9602305: '107 км',
            9601406: 'Приокская',
            9601917: 'Романовские дачи',
            9601668: 'Тарусская',
            9601906: '132 км',
            9600833: 'Пахомово',
            9600834: 'Шульгино',
            9601046: '153 км',
            9601630: 'Ясногорск',
            9601810: 'Шеметово',
            9601798: 'Бараново',
            9601652: 'Ревякино',
            9601824: 'Байдики',
            9601785: 'Хомяково',
            9600944: '191 км',
            9623131: 'Тула-1-курская',
        },
        'Ленинградское': {
            2006004: 'Москва (Ленинградский вокзал) [м.Комсомольская]',
            9603518: 'Рижская [м.Рижская]',
            9603505: 'Останкино',
            9603458: 'Петровско-Разумовское [м.Петровско-Разумовская]',
            9603478: 'Моссельмаш',
            9603877: 'Ховрино',
            9603663: 'Левобережье (Левобережная)',
            9603401: 'Химки',
            9603638: 'Планерная',
            9603404: 'Новоподрезково',
            9603406: 'Подрезково',
            9603486: 'Сходня',
            9603604: 'Фирсановская (Фирсановка)',
            9603766: 'Малино',
            9600212: 'Крюково',
            9603668: 'Алабушево',
            9603761: 'Радищево',
            9603411: 'Поваровка',
            9602925: 'Поварово-1',
            9603765: 'Берёзки-Дачные',
            9603468: 'Подсолнечная',
            9603714: 'Сенеж',
            9603732: 'Головково',
            9603708: 'Покровка',
            9603744: 'Фроловское',
            9603436: 'Стреглово',
            9602944: 'Клин',
            9603464: 'Ямуга',
            9602945: 'Решетниково',
            9603509: 'Черничная',
            9602593: 'Завидово',
            9603507: 'Московское Море',
            9602946: 'Редкино',
            9603423: 'Межево',
            9603871: 'Кузьминка',
            9603829: 'Чуприяновка',
            9603790: 'Лазурная',
            9603093: 'Тверь',
            9602947: 'Лихославль',
            9603013: 'Торжок',

            9603753: 'Путепроводная',
            9603888: 'Конаковский Мох',
            9603676: 'Донховка',
            9603735: 'Конаково ГРЭС',
        },
        'Павелецкое': {
            2000005: 'Москва (Павелецкий вокзал) [м.Павелецкая]',
            9602028: 'Москва-Товарная',
            9601985: 'ЗИЛ',
            9601975: 'Нижние Котлы [м.Нагатинская]',
            9601656: 'Коломенское [м.Варшавская]',
            9602125: 'Чертаново',
            9601698: 'Бирюлёво-Тов.',
            9601703: 'Бирюлёво-Пасс.',
            9601741: 'Булатниково',
            9600801: 'Расторгуево',
            9601646: 'Калинина',
            9602030: 'Ленинская',
            9633652: '32 км',
            9600811: 'Домодедово',
            9602296: 'Взлётная',
            9600767: 'Востряково',
            9601987: 'Белые Столбы',
            9601999: '52 км',
            9601332: 'Барыбино',
            9602029: 'Вельяминово',
            9600837: 'Привалово',
            9600749: 'Михнево',
            9601736: 'Шугарово',
            9633653: '85 км',
            9600694: 'Жилёво',
            9602067: 'Ситенка',
            9601202: 'Ступино',
            9601726: 'Акри',
            9600772: 'Белопесоцкий',
            9600886: 'Кашира',
            9600820: 'Тесна',
            9600754: 'Ожерелье',
            9633654: '121 км',
            9600755: 'Пурлово',
            9633999: '131 км',
            9602121: 'Топканово',
            9634000: '137 км',
            9600757: 'Богатищево',
            9601125: '146 км',
            9600758: 'Коровино',
            9633655: '152 км',
            9600759: 'Узуново',

            9601167: 'Авиационная',
            9601722: 'Космос',
            9600216: 'а/п Домодедово',

            9601153: '162 км',
            9601298: 'Дудино',
            9600760: 'Серебряные Пруды',
            9600762: 'Кораблёвка',
            9600763: 'Треполье',
            9601955: 'Виленки',
            9601155: 'Донцы',
            9600765: 'Михайлов',
            9600778: 'Бояринцево',
            9600779: 'Голдино',
            9601518: 'Лужковская',
            9601245: 'Волшута',
            9600780: 'Катино',
            9600782: 'Мшанка',
            9600783: 'Кремлево',
            9600784: 'Павелец-1-Тульский',

            9601277: '123 км',
            9601346: '126 км',
            9600787: 'Пчеловодное',
            9601225: '137 км',
            9601348: '142 км',
            9600788: 'Мордвес',
            9601118: '156 км',
            9600789: 'Настасьино',
            9601901: '163 км',
            9601904: '166 км',
            9634131: '168 км',
            9600790: 'Венёв',
            9601302: '180 км',
            9601183: 'Ольховка',
            9601233: '193 км',
            9600793: 'Грицово',
            9600794: 'Маклец',
            9600795: 'Узловая-2',
            9634132: 'Депо',
            9601750: 'Ключёвка',
            9600932: 'Урванка',
            9600956: 'Новомосковск-1',
            9600933: 'Сборная-Угольная',
            9601259: '23 км',
            9600926: 'Бобрик-Донской',
            9600966: 'Руднево',
            9600896: 'Узловая-1',

        },
        'Рижское': {
            2000008: 'Москва (Рижский вокзал) [м.Рижская]',
            9601266: 'Ржевская [м.Рижская]',
            9600901: 'Дмитровская [м.Дмитровская]',
            9601934: 'Гражданская',
            9601947: 'Красный Балтиец',
            9601688: 'Ленинградская',
            9601251: 'Покровское-Стрешнево',
            9600741: 'Тушино [м.Тушинская]',
            9602036: 'Трикотажная',
            9602460: 'Павшино',
            9601142: 'Красногорская',
            9601364: 'Опалиха',
            9601770: 'Аникеевка',
            9601122: 'Нахабино',
            9601748: 'Малиновка',
            9600871: 'Дедовск',
            9600675: 'Миитовская',
            9601442: 'Снегири',
            9602027: '50 км',
            9601651: 'Манихино 1',
            9601763: 'Троицкая',
            9601923: 'Истра',
            9601222: 'Новоиерусалимская',
            9600769: 'Чеховская',
            9602215: 'Холщёвики',
            9601729: '73 км',
            9601802: 'Ядрошино',
            9601780: 'Курсаковская',
            9602228: 'Румянцево',
            9601667: 'Новопетровская',
            9601778: 'Устиновка',
            9602285: '91 км',
            9601779: 'Лесодолгоруково',
            9601759: 'Чисмена',
            9601148: 'Матрёнино',
            9601422: 'Дубосеково',
            9600696: 'Волоколамск',
            9633657: '133 км',
            9600695: 'Благовещенское',
            9634001: '141 км',
            9600697: 'Бухолово',
            9633658: '149 км',
            9600706: 'Шаховская',
            9602502: 'Муриково',
            9634117: '165 км',
            9634118: '167 км',
            9602951: 'Княжьи Горы',
            9634119: '176 км',
            9634120: '180 км',
            9602952: 'Обовражье',
            9634121: '188 км',
            9602954: 'Погорелое Городище',
            9602503: 'Курково',
            9634122: '207 км',
            9602504: 'Бартенево',
            9602955: 'Зубцов',
            9602505: 'Аристово',
            9602963: 'Ржев-Балтийский',

        },
        'Савёловское': {
            2000009: 'Москва (Савёловский вокзал) [м.Савеловская]',
            9602463: 'Тимирязевская [м.Тимирязевская]',
            9601830: 'Окружная',
            9601117: 'Дегунино',
            9601805: 'Бескудниково',
            9600851: 'Лианозово',
            9602214: 'Марк',
            9601261: 'Новодачная',
            9600766: 'Долгопрудная',
            9601877: 'Водники',
            9601281: 'Хлебниково',
            9601996: 'Шереметьевская',
            9600781: 'Лобня',
            9602464: 'Депо',
            9602070: 'Луговая',
            9601757: 'Некрасовская',
            9601271: 'Катуар',
            9600679: 'Трудовая',
            9601681: 'Икша',
            9601673: 'Морозки',
            9601484: 'Турист',
            9601682: 'Яхрома',
            9600692: 'Дмитров',
            9601852: 'Каналстрой',
            9601704: '75 км',
            9601657: 'Орудьево',
            9600693: 'Вербилки',
            9602288: '94 км',
            9601140: 'Власово',
            9600686: 'Талдом',
            9601895: 'Лебзино',
            9633998: '124 км',
            9603083: 'Савёлово',

            9601273: 'Иванцево',
            9633659: '80 км',
            9602292: 'Драчёво',
            9602170: '74 км',
            9602171: '71 км',
            9602172: '68 км',
            9601386: 'Костино',
            9602173: '62 км',
            9602034: 'Жёлтиково',
            9602174: '47 км',
            9602031: 'Бубяково',
            9602175: '40 км',
            9602032: 'Наугольный',

            9601875: 'Соревнование',
            9602220: 'Запрудня',
            9601819: 'Темпы',
            9601807: 'Мельдино',
            9602209: '119 км',
            9601949: 'Карманово',
            9601720: 'Большая Волга',
            9601639: 'Дубна',

        },
        'Ярославское': {
            2000002: 'Москва (Ярославский вокзал) [м.Комсомольская]',
            9601018: 'Москва-3',
            9601882: 'Маленковская',
            9601236: 'Яуза',
            9601217: 'Северянин',
            9601716: 'Лосиноостровская',
            9600831: 'Лось',
            9600841: 'Перловская',
            9601001: 'Тайнинская',
            9600681: 'Мытищи',
            9601887: 'Строитель',
            9602281: 'Челюскинская',
            9601954: 'Тарасовская',
            9601246: 'Клязьма',
            9601241: 'Мамонтовская',
            9600701: 'Пушкино',
            9601435: 'Заветы Ильича',
            9601127: 'Правда',
            9601328: 'Зеленоградская',
            9601848: '43 км',
            9601315: 'Софрино',
            9602043: 'Ашукинская',
            9600774: 'Калистово',
            9600838: 'Радонеж',
            9601649: 'Абрамцево',
            9601286: 'Хотьково',
            9600724: 'Семхоз',
            9601389: 'Сергиев Посад',
            9601860: '76 км',
            9601684: '81 км',
            9601899: '83 км',
            9601719: 'Бужаниново',
            9602035: '90 км',
            9600792: 'Арсаки',
            9601358: 'Струнино',
            9601547: 'Александров-1',
            9604395: 'Мошнино',
            9604157: 'Балакирево',

            9600691: 'Подлипки-Дачные',
            9602217: 'Болшево',
            9600678: 'Валентиновка',
            9601296: 'Загорянская',
            9602066: 'Соколовская',
            9600861: 'Воронок',
            9601893: 'Щёлково',
            9602301: 'Фабрика 1 Мая',
            9601708: 'Зелёный Бор',
            9601883: 'Ивантеевка-2',
            9601633: 'Ивантеевка',
            9601541: 'Гагаринская',
            9601911: 'Чкаловская',
            9601379: 'Бахчиванджи',
            9600682: 'Циолковская',
            9601735: 'Осеевская',
            9601628: 'Детская',
            9602116: 'Фрязино-Тов.',
            9601361: 'Фрязино-Пасс.',
            9601862: 'Монино',
            9602122: 'Кашино',
            9601206: 'Колонтаево',
            9602097: 'Лесная (64 км)',
            9601680: 'Фрязево',

            9602268: 'Посёлок Дальний',
            9602123: 'Рахманово',
            9601159: 'Фёдоровское',
            9601522: 'Путилово',
            9601868: 'Красноармейск',

        },
    },
}


class Command(BaseCommand):

    help = 'Заполнить известные ж/д станции.'

    @transaction.commit_manually
    def handle(self, **options):

        for region_name, directions in STATIONS.items():
            self.stdout.write('Регион: %s' % region_name)
            region = Region.objects.create(name=region_name)
            for direction_name, stations in directions.items():
                self.stdout.write('  Направление: %s' % direction_name)
                Direction.objects.create(name=direction_name, region=region)
                for yandex_id, station_name in stations.items():
                    try:
                        self.stdout.write('    Станция: %s' % station_name)
                        Station.objects.create(name=station_name, yandex_id=yandex_id)
                    except IntegrityError:
                        # одна и та же станция может встречаться в разных направлениях
                        if station_name != Station.objects.get(yandex_id=yandex_id).name:
                            raise

        transaction.commit()
